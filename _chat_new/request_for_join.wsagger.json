{
   "wsagger": "0.0.3",
   "info": {
      "description": "GBKSOFT chat API",
      "version": "1.1.0",
      "title": "GBKSOFT chat API"
   },

   "name": "request for join",
  
   "data": [

      { 
              "action"  : "call.callWsaggerFile",
              "data"    : [ "./login_and_connect.wsagger.json", "{{REST.proto}}", "{{REST.host}}", "{{REST.port}}", "{{REST.path}}", "alexr", "", "{{server.proto}}", "{{server.host}}",  "{{server.port}}", "{{server.path}}" ],
              "wait"    : { "delay": 30000 }, 
              "expected": { "doer.socket_io": {} },
              "dataOut" : [ "doer.socket_io", "userId" ]
      },

      { 
                "action": "socket_io.emit", 
                "data": ["createGroup", {"type": "closed"}], 
                "expected": [["newGroup",  {"id": "{{!groupId}}"}]],
                "wait": { "delay": 3000 }
      },


      { 
                "action": "socket_io.emit", 
                "data": ["requestForJoin", {"groupId": "{{groupId}}", "messageText": "!!!"}], 
                "expected": [
                   ["requestAccepted",  {"groupId": "{{groupId}}", "messageText": "!!!"}], 
                   ["requestForJoin",   {"groupId": "{{groupId}}", "messageText": "!!!"}]
                ], 
                "wait": { "delay": 3000 }
      },


      {
        "action": "socket_io.emit", 
        "data": ["changeGroup", "{{groupId}}"],
        "wait": { "delay": 3000 },
        "expected": [
           ["joinedTo",       { "groupId": "{{groupId}}", "role": "owner" }],
           ["historySpecial", { "type":"group", "typeId":"{{groupId}}", "messages":[{}] }]
        ] 
      }

   ]

}
