{
   "wsagger": "0.0.2",
   "info": {
      "description": "API for GBK chat",
      "version": "1.0.0",
      "title": "GBKSOFT chat API"
   },

   "server" : {
      "proto": "socket.io",
      "host": "chat-nodejs.dev.gbksoft.net",
      "port": "28781",
      "path": "/front_space"
   },

   "autoStart": [0],

   "testSequence": [2,3,4,5,6,7,8,9],

   "scenarios": [
       {
          "name": "connect to socket.io with tokenapi25",
          "summary": " ",
          "parameters": [
             {             
                "in": "formData",
                "name": "token",
                "description": "",
                "dataType": "string"
             }
          ],
          "operationId": "connect",
          "flow": [
             {
                "action": "connect", 
                "key": "api25", 
                "data": [{"token": "api25"}]
             }
          ]
       },

       {
          "name": "connect to socket.io as alexr",
          "summary": " ",
          "parameters": [
          ],
          "operationId": "connect",
          "flow": [
             {
                "action": "login_and_connect", 
                "key": "alexr", 
                "data": [{"username": "alexr", "password": "alexr"}]
             }
          ]
       },

       {
         "name": "create open group",
         "summary": " ",
         "parameters": [
         ],
         "condition": "connect",
         "operationId": "",
         "flow": [        
             {
                "action": "request", 
                "key": "createGroup", 
                "data": [{"name": "333", "type": "open", "userIds": []}],
                "waitForResponse": {
                   "delay": 3000, 
                   "data": [["newGroup", {"name":"333", "type":"open", "usersCnt":1, "needBadgesNum":1, "needBadges":true}]]
                }
             }
         ]
       },

       {
         "name": "create closed group",
         "summary": " ",
         "parameters": [
         ],
         "condition": "connect",
         "operationId": "",
         "flow": [        
             {
                "action": "request", 
                "key": "createGroup", 
                "data": [{"name": "444", "type": "closed", "userIds": []}],
                "waitForResponse": {
                   "delay": 3000, 
                   "data": [["newGroup", {"name":"444", "type":"closed", "usersCnt":1, "needBadgesNum":1, "needBadges":true}]]
                }
             }
         ]
       },

       {
         "name": "send message to common group",
         "summary": " ",
          "parameters": [
             {
                "in": "formData",
                "name": "messageText",
                "description": "group message text",
                "dataType": "string"
             },
             {
                "in": "formData",
                "name": "groupId",
                "description": "group id",
                "dataType": "string"
             }
          ],
          "condition": "connect",
          "operationId": "",
          "flow": [
             {
                "action": "request", 
                "key": "sendMessage", 
                "data": [{"messageText": "@", "type": "group", "groupId": "1"}]
             }
          ]
       },

       {
         "name": "add user alexr to group 2",
         "summary": " ",
          "parameters": [
          ],
          "condition": "connect",
          "operationId": "",
          "flow": [
             {
                "action": "request", 
                "key": "addUser", 
                "data": ["2", "6"]
             }
          ]
       },

       {
         "name": "add user alexr to group 3",
         "summary": " ",
          "parameters": [
          ],
          "condition": "connect",
          "operationId": "",
          "flow": [
             {
                "action": "request", 
                "key": "addUser", 
                "data": ["3", "6"]
             }
          ]
       },

       {
         "name": "send message to group 2",
         "summary": " ",
          "parameters": [
             {
                "in": "formData",
                "name": "messageText",
                "description": "group message text",
                "dataType": "string"
             },
             {
                "in": "formData",
                "name": "groupId",
                "description": "group id",
                "dataType": "string"
             }
          ],
          "condition": "connect",
          "operationId": "",
          "flow": [
             {
                "action": "request", 
                "key": "changeGroup", 
                "data": ["2"]
             },
             {
                "action": "request", 
                "key": "sendMessage", 
                "data": [{"messageText": "@2", "type": "group", "groupId": "2"}]
             }
          ]
       },

       {
         "name": "send message to group 3",
         "summary": " ",
          "parameters": [
             {
                "in": "formData",
                "name": "messageText",
                "description": "group message text",
                "dataType": "string"
             },
             {
                "in": "formData",
                "name": "groupId",
                "description": "group id",
                "dataType": "string"
             }
          ],
          "condition": "connect",
          "operationId": "",
          "flow": [
             {
                "action": "request", 
                "key": "changeGroup", 
                "data": ["3"]
             },
             {
                "action": "request", 
                "key": "sendMessage", 
                "data": [{"messageText": "@3", "type": "group", "groupId": "3"}]
             }
          ]
       },

       {
          "name": "setReaded (all) to alexr",
          "summary": " ",
          "parameters": []
          ,
          "condition": "connect",
          "operationId": "",
          "flow": [
             {
                "action": "request", 
                "key": "setReaded", 
                "data": [{"senderId": "6"}]
             }
          ]
       },      

       {
         "name": "send message to user alexr",
         "summary": " ",
          "parameters": [
             {
                "in": "formData",
                "name": "messageText",
                "description": "group message text",
                "dataType": "string"
             },
             {
                "in": "formData",
                "name": "recipientId",
                "description": "recipient id",
                "dataType": "string"
             }
          ],
          "condition": "connect",
          "operationId": "",
          "flow": [
             {
                "action": "request", 
                "key": "sendMessage", 
                "data": [{"messageText": "@", "type": "user", "recipientId": "6"}]
             }
          ]
       },

       {
         "name": "send message to user tokenapi25",
         "summary": " ",
          "parameters": [
             {
                "in": "formData",
                "name": "messageText",
                "description": "group message text",
                "dataType": "string"
             },
             {
                "in": "formData",
                "name": "recipientId",
                "description": "recipient id",
                "dataType": "string"
             }
          ],
          "condition": "connect",
          "operationId": "",
          "flow": [
             {
                "action": "request", 
                "key": "sendMessage", 
                "data": [{"messageText": "@", "type": "user", "recipientId": "tokenapi25"}]
             }
          ]
       },

       {
         "name": "get users not in group",
         "summary": " ",
          "parameters": [
          ],
          "condition": "connect",
          "operationId": "",
          "flow": [
             {
                "action": "request", 
                "key": "getUsers", 
                "data": [{"notInGroup": "3"}]
             }
          ]
       },

       {
         "name": "set status",
         "summary": " ",
          "parameters": [
             {
                "in": "formData",
                "name": "status",
                "description": "new user status",
                "dataType": "string"
             }
          ],
          "condition": "connect",
          "operationId": "",
          "flow": [
             {
                "action": "request", 
                "key": "setStatus", 
                "data": ["dnd"]
             }
          ]
       },

       {
         "name": "set status invisible",
         "summary": " ",
          "parameters": [
          ],
          "condition": "connect",
          "operationId": "",
          "flow": [
             {
                "action": "request", 
                "key": "setStatus", 
                "data": ["invisible"]
             }
          ]
       },

       {
         "name": "set status offline",
         "summary": " ",
          "parameters": [
          ],
          "condition": "connect",
          "operationId": "",
          "flow": [
             {
                "action": "request", 
                "key": "setStatus", 
                "data": ["offline"]
             }
          ]
       }

    ]
}

