{
   "wsagger": "0.0.2",
   "info": {
      "description": "API for GBK chat",
      "version": "1.0.0",
      "title": "GBKSOFT chat API"
   },

   "server" : {
      "proto": "socket.io",
      "host": "{{{host}}}",
      "port": "{{{port}}}",
      "path": "{{{path}}}"
   },
   
   "scenarios": [
       {
          "name": "connect to socket.io as token2",
          "summary": " ",
          "parameters": [
             {             
                "in": "formData",
                "name": "namespace",
                "description": "connect to socket.io",
                "dataType": "string"
             }
          ],
          "operationId": "connect",
          "flow": [
             {
                "action": "connect", 
                "key": "2", 
                "data": []
             }
          ]
       },

       {
          "name": "connect to socket.io as token3",
          "summary": " ",
          "parameters": [
             {             
                "in": "formData",
                "name": "namespace",
                "description": "connect to socket.io",
                "dataType": "string"
             }
          ],
          "operationId": "connect",
          "flow": [
             {
                "action": "connect", 
                "key": "3", 
                "data": []
             }
          ]
       },

       {
          "name": "getUsers: notInGroup 333",
          "summary": " ",
          "parameters": [
          ],
          "operationId": "getUsers",
          "flow": [        
             {
                "action": "request", 
                "key": "getUsers", 
                "data": [{"notInGroup": "333"}]
             }
          ]
       },


       {
          "name": "getUsers: allRegistered",
          "summary": " ",
          "parameters": [
          ],
          "operationId": "getUsers",
          "flow": [        
             {
                "action": "request", 
                "key": "getUsers", 
                "data": [{"allRegistered": "1"}]
             }
          ]
       },

       {
          "name": "setStatus: do not disturb!",
          "summary": " ",
          "parameters": [
          ],
          "operationId": "getUsers",
          "flow": [        
             {
                "action": "request", 
                "key": "setStatus", 
                "data": ["dnd"]
             }
          ]
       },


       {
          "name": "send \"userIsWriting\" to token3",
          "summary": " ",
          "parameters": [
          ],
          "operationId": "userIsWriting",
          "flow": [        
             {
                "action": "request", 
                "key": "userIsWriting", 
                "data": ["token3"]
             }
          ]
       },

       {
          "name": "sendUserMessage to token3",
          "summary": " ",
          "parameters": [
             {
                "in": "formData",
                "name": "messageText",
                "description": "user message text",
                "dataType": "string"
             },
             {
                "in": "formData",
                "name": "recipientId",
                "description": "recipient id",
                "dataType": "string"
             }
          ],
          "operationId": "",
          "condition": "connect",
          "flow": [
             {
                "action": "request", 
                "key": "sendMessage", 
                "data": [{"messageText": "text: {{messageText}}", "type": "user", "recipientId": "token3"}]
             }
          ]
       },

       {
          "name": "setReaded (all) to token2",
          "summary": " ",
          "parameters": []
          ,
          "operationId": "",
          "flow": [
             {
                "action": "request", 
                "key": "setReaded", 
                "data": [{"senderId": "token2"}]
             }
          ]
       },

       {
         "name": "create closed group",
         "summary": " ",
         "parameters": [
         ],
         "operationId": "",
         "flow": [        
             {
                "action": "request", 
                "key": "createGroup", 
                "data": [{"userIds": ["token3"]}]
             }
         ]
       },

       {
         "name": "create closed group (333)",
         "summary": " ",
         "parameters": [
         ],
         "operationId": "",
         "flow": [        
             {
                "action": "request", 
                "key": "createGroup", 
                "data": [{"id": "333", "userIds": ["token3"]}]
             }
         ]
       },
   
       {
         "name": "changeGroup (333)",
         "summary": " ",
         "parameters": [
         ],
         "operationId": "",
         "flow": [        
             {
                "action": "request", 
                "key": "changeGroup", 
                "data": ["333"]
             }
         ]
       },     

       {
         "name": "create open group",
         "summary": " ",
         "parameters": [
         ],
         "operationId": "",
         "flow": [        
             {
                "action": "request", 
                "key": "createGroup", 
                "data": [{}]
             }
         ]
       },

       {
         "name": "create open group (777)",
         "summary": " ",
         "parameters": [
         ],
         "operationId": "",
         "flow": [        
             {
                "action": "request", 
                "key": "createGroup", 
                "data": [{"id": "777"}]
             }
         ]
       },


       {
         "name": "changeGroup (777)",
         "summary": " ",
         "parameters": [
         ],
         "operationId": "",
         "flow": [        
             {
                "action": "request", 
                "key": "changeGroup", 
                "data": ["777"]
             }
         ]
       },     

       {
          "name": "sendGroupMessage",
          "summary": " ",
          "parameters": [
             {
                "in": "formData",
                "name": "messageText",
                "description": "group message text",
                "dataType": "string"
             },
             {
                "in": "formData",
                "name": "groupId",
                "description": "group id",
                "dataType": "string"
             }
          ],
          "condition": "connect",
          "operationId": "",
          "flow": [
             {
                "action": "request", 
                "key": "changeGroup", 
                "data": ["333"]
             },
             {
                "action": "response", 
                "key": "message", 
                "data": [{"messageText": "@", "groupId": "333"}]
             }
          ]
       },
   
       {
          "name": "sendBroadcastMessage",
          "summary": " ",
          "parameters": [
             { 
               "in": "formData",
               "name": "messageText",
               "description": "broadcast message text",
                "dataType": "string"
             }
          ],
          "condition": "connect",
          "operationId": "",
          "flow": [
             {
                "action": "request", 
                "key": "sendMessage", 
                "data": [{"messageText": "@", "type": "broadcast"}]
             }
          ]
       }
    ]
}

