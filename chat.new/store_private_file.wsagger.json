{
   "wsagger": "0.0.3",
   "info": {
      "description": "GBKSOFT chat API",
      "version": "1.1.0",
      "title": "GBKSOFT chat API"
   },

   "REST_" : {
      "loc":  { "proto": "http://", "host": "localhost",                    "port": "28780", "path": "/rest" },
      "dev":  { "proto": "http://", "host": "chat-nodejs.dev.gbksoft.net",  "port": "28781", "path": "/rest" },
      "test": { "proto": "http://", "host": "chat-nodejs.test.gbksoft.net", "port": "28782", "path": "/rest" },
      "live": { "proto": "http://", "host": "chat-nodejs.live.gbksoft.net", "port": "28783", "path": "/rest" }
   },

   "server_" : {
      "loc":  { "proto": "socket.io", "host": "127.0.0.1",                    "port": "28780", "path": "/front_space" },
      "dev":  { "proto": "socket.io", "host": "chat-nodejs.dev.gbksoft.net",  "port": "28781", "path": "/front_space" },
      "test": { "proto": "socket.io", "host": "chat-nodejs.test.gbksoft.net", "port": "28782", "path": "/front_space" },
      "live": { "proto": "socket.io", "host": "chat-nodejs.live.gbksoft.net", "port": "28783", "path": "/front_space" }
   },

   "user_" : {
       "pavlo":      { "username": "pavlo",    "password": "pavlo" },
       "alexr":      { "username": "alexr",    "password": "alexr" },
       "roman":      { "username": "roman",    "password": "roman" },
       "olexandr":   { "username": "olexandr", "password": "olexandr" },
       "petr":       { "username": "petr",     "password": "petr" }
   },

   "scenarios": [
       {
          "name": "block open group",
          "parameters": [
          ],
          "data": [
             { 
                "action": "http.request",
                "data": {
                   "method": "POST", 
                   "host": "{{REST.host}}", 
                   "port": "{{REST.port}}", 
                   "path": "{{REST.path}}/v1/user/login", 
                   "headers": {"Content-Type": "application/x-www-form-urlencoded", "Accept": "application/json"},
                   "queryData":"username={{user.username}}&password={{user.password}}"
                },          
                "expected": { "result": { "token": "{{!token}}"}},
                "wait": {"delay": 5000} 
             },

             {
                "action": "socket_io.connect",           
                "data": { 
                   "url": "http://{{server.host}}:{{server.port}}{{server.path}}",            
                   "query": { "query": "token={{token}}" }
                },
                "expected": [[ "connected", {}]],
                "wait": {"delay": 3000}
             },

             {
                "action"  : "load.loadFile",
                "data"    : "png/0.png", 
                "dataOut" : "data", 
                "wait"    : { "delay": 3000 }
             },

             {
                "action"  : "socket_io.emit",
                "data"    : ["storeFile", { "fileName": "test.png", "contentType": "image/png", "contentLength": 40953, "messageType": "user", "messageTypeId": "0" }, "{{data}}"],
                "expected": [[ "fileIsStored", { "url": "{{!url}}", "path": "{{!path}}" } ]], 
                "wait"    : { "delay": 3000 }
             },

             { 
                "action": "http.request",
                "data": {
                   "method": "GET", 
                   "host": "{{REST.host}}", 
                   "port": "{{REST.port}}", 
                   "path": "{{REST.path}}{{path}}", 
                   "headers": {"Authorization": "Bearer {{token}}"}
                },          
                "wait": {"delay": 5000} 
             }


          ]
       }
    ]
}
